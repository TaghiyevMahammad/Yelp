# My Yield (React + TypeScript) with AWS Amplify (Docs + Local Mock)

This project is a React + TypeScript app prepared to use AWS Amplify for Authentication and a GraphQL API. Because you may not have an AWS account with billing enabled, this repo includes a safe "mock mode" so you can run it locally without connecting to AWS, plus full step-by-step documentation of how you would normally set up and deploy with Amplify.

## 1) Prerequisites

- Node.js LTS installed. Verify with:

```bash
node -v
npm -v
```

- Optional (for later): AWS account with billing enabled and the AWS CLI + Amplify CLI installed.

## 2) Install dependencies

From the project root (`my_yield`):

```bash
npm install
```

What this does:
- Downloads packages listed in `package.json` into `node_modules/`.
- Creates a lockfile (`package-lock.json`) to record exact versions.

## 3) Run locally (mock mode)

```bash
npm start
```

What happens:
- Runs `react-scripts start` which starts a development server on `http://localhost:3000`.
- The app detects there is no Amplify backend configured and switches to a mock mode. You can type values and add restaurants locally; no network calls are made.

Where the mock is defined:
- `src/aws-exports.ts` is a small placeholder config. In a real Amplify project, this file is auto-generated by `amplify push`.
- `src/App.tsx` checks whether an AppSync endpoint exists. If not, it avoids real API calls and Cognito sign-in and runs entirely in-memory.

## 4) How Amplify would normally be set up (Documentation Only)

Even if you cannot run these now, document these steps in your project notes. The steps below assume you have an AWS account with billing enabled and the Amplify CLI installed.

### 4.1 Install the Amplify CLI (once)

```bash
npm install -g @aws-amplify/cli
```

Sign in to AWS from the CLI and initialize credentials for Amplify:

```bash
amplify configure
```

What `amplify configure` does:
- Opens the AWS console to create an IAM user with the right permissions.
- Stores AWS credentials locally so the CLI can create cloud resources on your behalf.

### 4.2 Initialize Amplify in this project

Run in the project root (`my_yield` directory):

```bash
amplify init
```

You will be prompted for:
- Environment name (e.g. `dev`).
- Default editor (pick one).
- App type: JavaScript; framework: React.
- Build command: `npm run build`, start command: `npm start`.
- AWS profile: choose the profile created during `amplify configure`.

What this does:
- Creates an `amplify/` folder with backend definitions.
- Provisions an Amplify app environment in your AWS account (on `amplify push`).

### 4.3 Add Authentication

```bash
amplify add auth
```

Choose the default configuration (username sign-up). This creates a Cognito User Pool for sign-in/sign-up.

### 4.4 Add GraphQL API

```bash
amplify add api
```

Choose:
- `GraphQL`
- Authorization: `Amazon Cognito User Pool`
- Provide a schema. Example schema for this app:

```graphql
type Restaurant @model {
  id: ID!
  clientId: String
  name: String!
  description: String!
  city: String!
}
```

What this does:
- Sets up AWS AppSync (GraphQL) with DynamoDB tables and generates queries/mutations/subscriptions.

### 4.5 Push backend to AWS

```bash
amplify push
```

What `push` does:
- Creates/updates the AWS resources (Cognito, AppSync, DynamoDB).
- Generates `src/aws-exports.js` (or `.ts`) containing endpoints and IDs; your app imports this file.

### 4.6 Add hosting and publish

Option A: Manual hosting from CLI

```bash
amplify add hosting
amplify publish
```

What this does:
- Provisions Amplify Hosting resources.
- Builds your app and uploads it to Amplify Hosting.
- Outputs a URL like `https://yourappid.amplifyapp.com`.

Option B: Git-based Amplify Console

- Push your code to GitHub/GitLab/CodeCommit.
- In the AWS Amplify Console, connect your repo and select the branch.
- Amplify will build and deploy on every commit to that branch.

## 5) Switching from mock mode to real backend (later)

After you run `amplify push`, the CLI will create `src/aws-exports.js` automatically. Replace the local placeholder with the generated file (or keep TypeScript and import the generated file accordingly). Then, restart the dev server:

```bash
npm start
```

Now the app will:
- Require sign-in via Cognito (the UI wrapper is applied automatically).
- Use AppSync GraphQL for list/create/subscribe operations.

## 6) Project scripts

From `package.json`:
- `npm start`: starts the dev server with hot reloading.
- `npm run build`: creates a production build in `build/`.
- `npm test`: runs tests if present.

## 7) .gitignore

This repo ignores `node_modules/`, build outputs, and Amplify auto-generated files (including `src/aws-exports.*`).

## 8) Placeholder deployment URL

See `my_yelp_url.txt`. In a real `amplify publish`, Amplify prints a public URL like `https://something.amplifyapp.com`. Because we cannot deploy here, that file just contains a placeholder.
